<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-signals/iron-signals.html">
<link rel="import" href="../bower_components/paper-slider/paper-slider.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/neon-animation/neon-animation-runner-behavior.html">
<link rel="import" href="../bower_components/neon-animation/animations/scale-up-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/scale-down-animation.html">
<link rel="import" href="../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../bower_components/paper-slider/paper-slider.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">
<link rel="import" href="player-list.html">
<link rel="import" href="player-playing.html">
<dom-module id="player-main">
	<style type="text/css">
		:host
		{
			width:100%;
			height:100vh;
			display:flex;
			flex-direction: column;
			background-color:var(--paper-grey-50);
			box-shadow:0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
			position:relative;
		}
		#toggleShowPlayList
		{
			position:absolute;
			top:0px;
			left: 0px;
			z-index:100;
			color:white;
		}
		#playingContainer
		{
			width:100%;
		}
		#playerVertFlex
		{
			display:flex;
			flex-direction: column;
			align-items: flex-start;
			height:100%;
		}
	</style>
	<template>
			<paper-icon-button id="toggleShowPlayList" icon="list" on-click="showPlayList"></paper-icon-button>
			<div id="playerVertFlex">
				<player-list id="playListContainer" play-list="[[toPlayTracks]]"></player-list>
				<player-playing id="playingContainer" currently-playing="{{currentTrack}}" on-playback-end="playBackEnded"></player-playing>
			</div>
		<iron-signals on-iron-signal-playlist-update="updatePlayList"></iron-signals>
	</template>
	<script type="text/javascript">
		var playing = false;

		Polymer({
			is:"player-main",
			properties:
			{
				toPlayTracks:
				{
					type:Object,
					notify:true
				},
				currentTrack:
				{
					type:Object,
					notify:true
				},
			   _showing: {
			        type: Boolean,
			        value: false
		      	}
			},
			ready:function()
			{
				this.toPlayTracks = 
					{
						"tracks":[
							{
								"name":"Nothing to see here.",
								"artist":"foo",
								"album":"Hello World!",
								"length":"3:56"
							}
						],
						"startIndex":0
					};				
			},
		   	showPlayList:function()
		   	{
		   		//this.$$("#playingContainer").show();
		   		this.$.playListContainer.changeVisible();
		   		this.$.playingContainer.changePlayerMode("tiny");
		   	},
		   	playBackEnded:function()
		   	{
		   		this.$$("#playListContainer").playNextTrack();
		   	},
		   	updatePlayList:function(e, detail, sender)
		   	{
		   		this.toPlayTracks = detail;
		   		this.currentTrack = detail.tracks[detail.startIndex];
		   	}
		});
	</script>
</dom-module>